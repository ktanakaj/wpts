=====================================================================
【タイトル】 Wikipedia 翻訳支援ツール
【ファイル】 wptscs110.zip
【作成月日】 2012/1/30
【制 作 者】 Honeplus
【動作環境】 Windows Vista/7 での動作を確認。要.NET Framework 4.0 Client Profile
【配布形態】 修正BSDライセンス
【HomePage】 http://sourceforge.jp/projects/wptscs/
=====================================================================

・概要
Wikipediaでの言語間翻訳をサポートするためのツールです。
指定されたWikipediaの記事に存在する内部リンク先を確認し、その言語間リンクを取得します。
また、登録されていれば、見出しも変換します。

※Wikipedia以外でも同じシステムのサイト（例えばWikipedia姉妹サイト）
  なら使えるかもしれませんが、未確認です。



・インストール方法
適当なフォルダに展開してください。
展開して出てくる以下のファイルが、最低限必要なファイルです。他は消しても問題ありません。

wptscs.exe        : 実行ファイル
hmlib.dll         : 実行に必要なdll
wptscs.exe.config : デフォルト値やプログラム的な設定ファイル
config.xml        : Wikipediaの各サーバーに関する設定ファイル

アプリケーション上で設定した内容は、上記設定ファイルには反映されません。
ユーザーごとのフォルダに出力されます。
設定ファイルを直接修正、または削除して初期値に戻したい場合は、
下記のようなパスにあるファイルを更新してください（以下はVistaの例）。

C:\Users\[ユーザー名]\AppData\Roaming\Honememo\Wikipedia 翻訳支援ツール\[バージョン番号]\config.xml
C:\Users\[ユーザー名]\AppData\Local\Honememo\Wikipedia 翻訳支援ツール\[バージョン番号]\user.config



・アンインストール方法
展開したファイルと必要なら上記設定ファイルを削除してください。レジストリ等は一切いじりません。



・使い方
翻訳元／先言語と、処理結果の出力先フォルダを指定してから、翻訳したい翻訳元記事名を入力して実行してください。

設定画面については、通常は触る必要はないです。
言語間リンクが貼られていない記事の対応パターン登録や、キャッシュの確認、
言語コードの登録や、見出しの変換パターンの設定ができます。
設定の内容などは、ツールチップと既存の値を見れば概要はつかめるのではないかと思います。

なお、このプログラムはあくまで「翻訳支援ツール」です。
出力された文章は、その後Wikipediaの編集画面やプレビューなりで本格的に修正されることを前提としています。
間違っても、そのままWikipediaに投稿するなどしないでください。
また、当プログラムではWikipediaへの書き込みは一切行いません。

※ 特にテンプレート等の複雑な書式の記事で使用した場合、一部が正常に処理されない可能性あります。
   これらの記事で使用する際は、処理結果に異常が無いか注意しながらご利用ください。



・処理結果の詳細
処理結果として、実行ログと記事テキストの内部リンク等を置き換えたものを出力します。

記事テキストの置き換えについては、下記のようなルールで実行しています。
（以下、英語版→日本語版で適当な記事を例に）

例）[[Japan]]

言語間リンクがある場合    →  [[日本|Japan]]
言語間リンクがない場合    →  [[:en:Japan|Japan]]
ない場合で仮リンクが有効  →  {{仮リンク|Japan|en|Japan|label=Japan}}
英語版も赤リンクの場合    →  [[Japan]]

例）[[Japan|Nihon]]

言語間リンクがある場合    →  [[日本|Nihon]]
言語間リンクがない場合    →  [[:en:Japan|Nihon]]
ない場合で仮リンクが有効  →  {{仮リンク|Japan|en|Japan|label=Nihon}}
英語版も赤リンクの場合    →  [[Japan|Nihon]]

例）[[Category:Japan|sortkey]]

言語間リンクがある場合    →  [[Category:日本|sortkey]]
言語間リンクがない場合    →  [[:en:Category:Japan]]<!-- [[Category:Japan|sortkey]] -->
英語版も赤リンクの場合    →  [[Category:Japan|sortkey]]

例）{{Citation needed|date=January 2012}}

言語間リンクがある場合    →  {{要出典|date=January 2012}}
言語間リンクがない場合    →  [[:en:Template:Citation needed]]<!-- {{Citation needed|date=January 2012}} -->
英語版も赤リンクの場合    →  {{Citation needed|date=January 2012}}

例）==History==

見出し変換表に登録あり    →  ==歴史==
見出し変換表に登録なし    →  ==History==



・ソースについて
src.zipにソースファイルをまとめています。開発環境はVisual C# 2010 Expressです。
その他外部ツールとしてテスト自動化ツールのnUnitと、コーディングスタイルチェック用のStyleCopを使用しています。



・その他
このプログラムは修正BSDライセンスに基づいたフリーソフトウェアで、無保証です。
このプログラムを利用して何らかの被害をこうむっても、作者は一切責任を負いません。
またサポートする保証もありません。
このプログラムの変更・再配布・流用はご自由にどうぞ。


また、ソース中にNUnitのテストデータとしてWikipediaより取得したXMLを同梱しています。
これらファイル内の著作物の扱いについては、日本語版／英語版の各Wikipediaのライセンスに従ってください。



・更新履歴
Ver0.80  2010/09/18 開発環境／言語をVisual Studio 2005のC++/CLI→Visual C# 2010 Expressに移行。
                    ソースも全面的に見直し（ただし現在は古いコードが多々残った状態）。
                    設定画面を全体的に変更。記事の対応パターンを登録できるよう対応。
                    キャッシュ状況も見えるように変更。

Ver0.90  2010/09/27 Template:Documentationが使われているページに対応。
                    無駄に遅くなっていた処理を改善。その他細かい部分を改良／修正。

Ver1.00  2011/04/22 Wikipediaのバージョンアップごとに設定ファイルを直さなくて済むよう対処。
                    無駄に遅くなっていた処理を改善。
                    設定画面のツールチップや入力値チェックを整備。
                    [[ファイル:～]]→[[File:～]]も変換するよう対応。
                    [[Apollo&nbsp;17]]のように特殊文字が入っているリンクを処理できるよう修正。
                    HTMLタグの解析で正規表現の構文エラーになる可能性があったのを修正。
                    config.xmlの日英以外の言語の設定を精査・補填。

Ver1.01  2011/10/05 MediaWikiのバージョンアップに伴いAPIの仕様が変わったため対応。

Ver1.10  2012/01/30 ソースの全体的なリファクタリングを実施。
                    言語間リンクが無い記事の{{仮リンク}}への置き換えに対応。
                    {{Doc}}→{{Documentation}}のリダイレクトとインラインコンテンツに対応。
                    .net framework 4 フル版でなく Client Profile で動作するよう改善。
                    処理状況をステータスバーに表示するよう変更。
                    各種設定の文字列埋め込みを{0}から$1形式に変更。
                    [[File:～|]]のコメント部分を処理対象とするよう対応。
                    キャッシュ済みテンプレートの処理時に余分な通信をしていたのを修正。
                    [[Help:条件文]]の関数をテンプレートとして処理しようとしてしまっていたのを修正。
                    初期設定を若干追加。
                    配布元をSourceForge.JPに移転。
                    ※ 処理の見直しも行っているため、上記以外の細かい部分の動作にも変更が生じているはずです。
                    ※ 1.01とは設定ファイルの互換性がありません。



・既知の不具合
ピリオドで終わるページが取得できず、存在しないものとして扱われる。
（例、[[Vulcan Inc.]]）

記事名にコロンを含むページが正しく処理できない。
（例、[[Marathon 2: Durandal]]）

階層の深いサブページが正しく処理できない。
（例、[[../../サブページ]]）

キャッシュの一覧で一度に大量の項目を削除すると、フリーズしたかのように時間がかかる。

その他、Wikipedia上言語間リンクが存在しても、現行のアプリでは見つけられないページもあります。
（例、<noinclude>で埋め込まれている{{Refend}}, どうやってるかよく分からない {{Documentation}}）
これらについては対応できない特殊ケースとして、設定→記事の置き換えに変換パターンを初期設定しています。
